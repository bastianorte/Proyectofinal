
<% if user_signed_in? %>
<div class="container pt-4">

<p id="notice"><%= notice %></p>
<div class="row">
<h1>Families</h1>
</div>


<% @families.each do |family| %>
<div class="row">


      <div class="col"> <%= family.name %> </div>
      <div class="col">  <%= family.photo %> </div>
      <div class="col">  <%= link_to 'Show', family %> </div>
      <div class="col">  <%= link_to 'Edit', edit_family_path(family) %> </div>
      <div class="col">  <%= link_to 'Destroy', family, method: :delete, data: { confirm: 'Are you sure?' } %> </div>

</div>
<% end %>
<div class="row">
<%= link_to 'New Family', new_family_path %>
</div>

<div class="row">
    <h1>Usuarios</h1>
    </div>

    <div class="card">
      <div class="card-body">
        <div class="row">
            <div class="col-2">Foto</div>
            <div class="col">Caracteristicas</div>
            <div class="col">Estadisticas</div>
            <div class="col"></div>
        </div>
      </div>
    </div>


    <% @users.each do |user| %>
    <div class="card">
      <div class="card-body">
          <div class="row">
            <div class="col-2"><img src="<%= user.photo.thumb %>" style="width:120px;">  </div>
            <div class="col">
                Nombre: <%= user.name %> <br>
                Edad: <%= user.age %><br>
                Peso: <%= user.weight %><br>
                Altura: <%= user.height %><br>
                Actividad fisica <%= user.physical_activity_level %><br>
                Carbohidratos <%= user.daily_carbohydrates %><br>
                Email: <%= user.email %><br>
                Familia: <%= user.family %><br>

            </div>
            <div class="col"><h3>Calorias</h3>
                              <canvas data-calorie= "<%= user %>"  id="pie-chart<%= user.id %>" width="" height=""></canvas>
                              <script>
                              new Chart(document.getElementById("pie-chart<%= user.id %>"), {
                                type: 'pie',
                                data: {
                                  labels: ["Calorias necesarias", "Calorias consumidas"],
                                  position: 'left',
                                  datasets: [{
                                    backgroundColor: ["#3e95cd", "#8e5ea2"],
                                    data: [<%= user.daily_calories %>,<%= user.foods.sum(:calorie) %>]
                                  }]
                                },
                                options: {
                                  legend: {
                                    display: true,
                                    position: 'right',
                                    labels: {

                                            }
                                          }

                                }
                              });

                              </script>
                              <br>
            </div>
            <div class="col"><h3>IMC</h3>
              <div class="progress">
                <div class="progress-bar" role="progressbar" style="width: 15%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100"></div>
                <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
                <div class="progress-bar bg-info" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
              </div>

                              <br>
            </div>

        </div>
          <div class="row"><div class="col">

            <%= link_to 'Nuevo alimento', new_family_path,  { 'data-toggle' =>  "modal", 'data-target' => '#modal-window', class: 'btn btn-outline-primary btn-sm'}  %>

            <div id="modal-window" class="modal" role="dialog" aria-labelledby="myModalLabel">

              <div class="modal-dialog" role="document">

                <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Modal title</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <p>

                          <%= form_for(@event) do |f| %>
                            <div class="field">
                            <%= f.label :food_id %>
                            <%= f.collection_select(:food_id, Food.all, :id, :name) %>
                            </div>
                            <%= f.hidden_field :user_id, :value => user.id %>




                        </p>
                      </div>
  <div class="modal-footer">
    <%= f.submit %>
    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button><% end %>
  </div>

              </div>

            </div>
        </div>

      </div>
      </div>
      </div>
    <% end %>





</div>

<% else %>
<%= render'families/otro' %>
<% end %>
